; Listing generated by Microsoft (R) Optimizing Compiler Version 19.31.31107.0 

	TITLE	C:\Users\sebastien.durand\source\Intro-4Kbyte-Kelenian\i4k_Bibli1\bin\vc2015\Release\intro.obj
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	??_C@_0KH@FAIDBDIH@?$CDversion?5430?6layout?$CIlocation?$DN0?$CJ@ ; `string'
PUBLIC	?fsh@@3PBDB					; fsh
PUBLIC	??_C@_0BOEF@ICOFMCO@?$CDversion?5430?6layout?$CIlocation?$DN0?$CJ@ ; `string'
;	COMDAT ??_C@_0BOEF@ICOFMCO@?$CDversion?5430?6layout?$CIlocation?$DN0?$CJ@
CONST	SEGMENT
??_C@_0BOEF@ICOFMCO@?$CDversion?5430?6layout?$CIlocation?$DN0?$CJ@ DB '#v'
	DB	'ersion 430', 0aH, 'layout(location=0)uniform float v;layout(l'
	DB	'ocation=0)out vec4 f;in vec2 m;int x=0;vec3 y=vec3(0);vec2 s('
	DB	'vec2 v){v=fract(v*vec2(5.3983,5.4427));v+=dot(v.yx,v+vec2(21.'
	DB	'5351,14.3137));return fract(v.x*v.y*vec2(95.4337,97.597));}fl'
	DB	'oat t(vec2 v){vec2 m=floor(v);v-=m;v*=v*v*(v*v*6.-v*15.+10.);'
	DB	'return dot(mat2(fract(sin(mod(vec4(0,1,113,114)+dot(m,vec2(1,'
	DB	'113)),6.28319))*43758.545))*vec2(1.-v.y,v.y),vec2(1.-v.x,v));'
	DB	'}float p(vec2 v){return t(v)*.533+t(v*2.)*.267+t(v*4.)*.133+t'
	DB	'(v*8.)*.067;}float p(vec3 v,vec3 m){m=max(m*m,.001);m/=m.x+m.'
	DB	'y+m.z;return p(v.yz)*m.x+p(v.zx)*m.y+p(v.xy)*m.z;}vec3 s(vec3'
	DB	' v,vec3 m){vec3 y=vec3(p(vec3(v.x-.001,v.yz),m),p(vec3(v.x,v.'
	DB	'y-.001,v.z),m),p(vec3(v.xy,v.z-.001),m));y=(y-p(v,m))/.002;y-'
	DB	'=m*dot(m,y);return normalize(m+y*.2);}mat2 n(float v){float m'
	DB	'=cos(v),y=sin(v);return mat2(m,y,-y,m);}void n(inout float v,'
	DB	'float m){v-=clamp(round(v),0.,m);}float d(vec3 v){vec3 m=v;n('
	DB	'm.y,9.);m.x-=clamp(m.x,-.8,.8);v.x=abs(v.x)-.75;v.y-=clamp(v.'
	DB	'y,0.,10.);return min(length(m)-.07,length(v)-.1);}float d(vec'
	DB	'3 v,vec3 m){vec3 y=abs(v)-m;return min(max(y.x,max(y.y,y.z)),'
	DB	'0.)+length(max(y,0.));}void r(inout vec2 v){v=(v+vec2(v.y,-v.'
	DB	'x))*.707;}float i(vec3 v){r(v.xy);v.z=abs(v.z);float m=d(v-ve'
	DB	'c3(0,0,3),vec3(1.2,24,.05));n(v.y,24.);r(v.yx);return min(m,d'
	DB	'(v,vec3(.45,.5,3))-.05);}vec3 c(vec3 v){vec3 m=v;v=sin(v*4.3+'
	DB	'cos(v.yzx*6.7));float y=dot(v+sin(v*13.)*.03,vec3(3)),x=1.-ab'
	DB	's(dot(sin(m*120.5+y*6.283+sin(m.zxy*121.3)),vec3(.333)));y=fr'
	DB	'act(y+fract(y*4.)*.1);y=min(y,y*(1.-y)*6.);float f=min(y*.85+'
	DB	'x*.2,1.);return.3+.7*sqrt(mix(vec3(.5,.15,.025),vec3(.75,.3,.'
	DB	'1)*2.,f*.75+.25))*(f*.6+.4);}vec3 a(vec3 v){vec2 m=vec2(6,.8)'
	DB	',y=floor((v.zx+m/2.)/m);v.z+=mod(y.y,2.)*m.x*.5;y=floor((v.zx'
	DB	'+m/2.)/m);v.zx=m*(fract(v.zx/m+.5)-.5);y*=m;float x=s((y+120.'
	DB	')*80.).x;return c((v+x)*.5*vec3(1.5,1.5,.15))*mix(.1,1.,smoot'
	DB	'hstep(0.,-.02,d(vec3(v.zx,0),vec3(m,99)*.5)))*mix(.5,1.,x);}v'
	DB	'ec2 a(vec2 v,vec2 m){return v.x<m.x?v:m;}vec2 e(vec3 v){v.xy*'
	DB	'=n(.4);v.xy*=n(1.26);v.y=abs(v.y);v.xy*=n(1.26);v.x-=.5+v.y*.'
	DB	'4*3.14159;v.y-=.12;float m=min(d(v,vec3(.5,0,.75)),d(v-vec3(-'
	DB	'.65,.02,-.02),vec3(.12,0,.68)))-.018;v.y-=.01+sin(v.x*6.9+5.7'
	DB	')*.027/(1.+v.x)-.12;return a(vec2(m,70),vec2(.7*d(v,vec3(.48,'
	DB	'.06,.73)),2));}vec2 a(vec3 v,float y,float m,float x,vec3 c){'
	DB	'v-=vec3(-y*.5,m,0);v.xy*=n(.01*x-.02);float f=max(d(v,vec3(y*'
	DB	'.45-.03,m,m*.66))-.03,-d(v-vec3(0,-.2,.05),vec3(y*.45-.06,m+.'
	DB	'5,m*.66+.03))+.03);return a(vec2(d(v,vec3(y*.45-.01,m-.01,m*.'
	DB	'6)),15),vec2(f,52.+50.*cos(112.*(5.*c.z+10.*x+11.*c.y+5.*cos('
	DB	'c.x)))));}vec2 a(vec3 m,vec3 v,vec3 y,vec3 x){v-=m;y-=m;x-=m;'
	DB	'vec3 f,n=cross(v,y),z=cross(y,x),c=cross(x,v),i=n+z+c;float r'
	DB	',s=-dot(c,i),d=-dot(n,i),l=-dot(z,i);f=(l-d)*y+(d+s*.5)*x+(-l'
	DB	'-s*.5)*v;r=clamp((s*.5+d-.5*(s*s*.25-d*l)*dot(f,v-2.*y+x)/dot'
	DB	'(f,f))/-dot(i,i),0.,1.);return vec2(length(mix(mix(v,y,r),mix'
	DB	'(y,x,r),r)),r);}vec2 h(vec3 m){float f=length(m);if(f>3.&&x=='
	DB	'0)return vec2(f-2.9,10);vec3 c=m;f=d(c,vec3(.3,.6,.2))-.1-.1*'
	DB	'c.y;vec2 i=a(c,vec3(0,.6,.1),vec3(0,.9,-.4),vec3(0,1.6,.2));c'
	DB	'.x=abs(c.x);c.xz*=n(-.2);f=min(f,d(c-vec3(.4,-1.8,1.3),vec3(.'
	DB	'2,.12,.4)));i=a(i,a(c,vec3(.2,-.6,0),vec3(.6,-.3,1.5),vec3(.4'
	DB	',-1.8,1)));i=a(i,a(c,vec3(.5,.6,0),vec3(.9,-.3,-.5),vec3(.8,0'
	DB	',1.3)));float r,l=cos(60.*i.y);i+=vec2(-.08,l>.6?50.:25.);c=m'
	DB	'-vec3(0,1.9,.5);l=smoothstep(80.,84.,v);r=smoothstep(86.,101.'
	DB	',v);c.xy*=n(.4*r-.2);c.zy*=n(l-.5-.5*r);c.xz*=n(-1.6*r);y=c;v'
	DB	'ec2 z=vec2(d(c,vec3(.9,.6,.5)),50.5);c.x=abs(c.x);i=a(i,vec2('
	DB	'length(c-vec3(.75,0,0))-.3,25));float s=length(c-vec3(.3,-.05'
	DB	',.25))-.3;c=m+vec3(0,0,-1.4);c.yz*=n(-.7);if(v<79.)z=a(z,e(c)'
	DB	');c.x=abs(c.x);c.xy*=n(.2);f=min(f,d(c-vec3(1,-.05,0),vec3(.2'
	DB	',.15,.2))-.05);z=a(z,vec2(f,50));z=a(z,vec2(s,-1));return a(z'
	DB	',i);}vec2 w(vec3 m){vec3 y=m,c=m,x=m-vec3(-20,19.65,3);x.xz*='
	DB	'n(.4);vec2 f=h(x);float z=d(m-vec3(5,30,5),vec3(15,30,5));y.y'
	DB	'=mod(y.y+10.,17.5)-10.;f=a(f,vec2(max(-z,d(y+vec3(0,-.1,0),ve'
	DB	'c3(999,.1,999))),1));f=a(f,vec2(i(m-vec3(6.7,0,5)),.37));y.x='
	DB	'mod(y.x+1.5,3.)-1.5;f=a(f,vec2(max(-z,d(y-vec3(0,-.5,0),vec3('
	DB	'.17,.45,999))),.3));y=m-vec3(10,0,-2.5);y.xz=mod(y.xz+36.,72.'
	DB	')-36.;y.zy*=n(-.2);y.x-=18.;f=a(f,vec2(d(y),.3));m.z=mod(m.z+'
	DB	'5.,10.)-5.;x=m;vec2 r=.2+.1*cos(2.*x.xy)+.2*cos(.3*x.xy);f=a('
	DB	'f,vec2(d(x-vec3(0,15.8,0),vec3(999,.85-r.x,.65-r.x))-r.x,.8))'
	DB	';x.z=abs(x.z)-1.1;x.x=mod(x.x+6.,12.)-6.;f=a(f,vec2(d(x,vec3('
	DB	'.5-r.y,100,.5-r.y))-r.y,.5));f=a(f,vec2(d(x,vec3(.5,.3,.5))-.'
	DB	'1-.05*cos(6.*x.y),8.5));f=a(f,vec2(d(x-vec3(0,16.8,0),vec3(.4'
	DB	'5,.45,1e3))-.2,.6));f=a(f,vec2(d(x-vec3(0,14.7,-.5),vec3(.2,.'
	DB	'27,.6))-.05,.5));f=a(f,vec2(d(x-vec3(0,14.7,0),vec3(.7,0,0))-'
	DB	'.05,.3));x-=vec3(0,15.5,1.7);x.zy*=n(.72);f=a(f,vec2(d(x,vec3'
	DB	'(.17,.2,2.6))-.1,.5));x.z=abs(x.z);f=a(f,vec2(d(x-vec3(0,0,2)'
	DB	',vec3(.7,0,0))-.05,.3));x=m;x.z-=2.5;x.x=mod(x.x+30.,48.)-11.'
	DB	';x.y=mod(x.y+13.,17.5)-13.;f=a(f,vec2(d(x-vec3(0,1.4,0),vec3('
	DB	'2.4,0,.8))-.1,.3));x.xz=abs(x.xz);x.xy*=n(.1);f=a(f,vec2(d(x-'
	DB	'vec3(1.6,.6,.6),vec3(0,.7,0))-.1,4.5));x=m;x.x=mod(x.x+36.,72'
	DB	'.)-36.;float l=min(d(x-vec3(18,1000,0),vec3(6.01,1000,1000)),'
	DB	'd(c-vec3(0,15.25,0),vec3(1000,2.2,1000)));x=m;x.y=mod(x.y+.3,'
	DB	'2.5)-1.25;f=a(f,vec2(max(-l,d(x,vec3(1e3,.1,.7))),.8));x=m;x.'
	DB	'y=mod(x.y-.5,2.5)-.5;float p=floor(x.x),e=.04,w=floor(m.y/2.5'
	DB	'),I=.25*smoothstep(45.,90.,v);vec2 b=vec2(99,0),k;if(v<77.){f'
	DB	'or(float t=0.;t<7.;t++){k=vec2(.1,.5)+vec2(.1,.2)*s(vec2(t,p+'
	DB	'10.*w));if(e+k.x>=.98)break;e+=k.x;if(k.x>I)b=a(b,a(x-vec3(p+'
	DB	'e,0,0),k.x,k.y,t,vec3(p,w,floor(c.z+.5))));}b.x=max(min(b.x,x'
	DB	'.x-p>.5?d(x-vec3(p+1.5+10.,.7,0),vec3(10.485,.7,.462)):d(x-ve'
	DB	'c3(p-.5-10.,.7,0),vec3(10.485,.7,.462))),-l);}return a(f,b);}'
	DB	'float c(vec3 v,vec3 m){float f,x=1.,y=.02+.05*s(m.xy+9123.*m.'
	DB	'z).x;for(int i=0;i<24;i++){f=w(v+m*y).x;x=min(x,2.*f/y);y+=cl'
	DB	'amp(f,.02,.1);if(f<.001||y>2.5)break;}return clamp(x,0.,1.);}'
	DB	'vec3 e(vec3 v,vec3 m){vec3 f=vec3(0);for(int x=0;x<4;x++){vec'
	DB	'3 y=.5773*(2.*vec3(x+3>>1&1,x>>1&1,x&1)-1.);f+=y*w(v+.002*y).'
	DB	'x;}return normalize(f-max(0.,dot(f,m))*m);}float h(vec3 v,vec'
	DB	'3 m){float y,x=0.,f=1.;for(int i=0;i<5;i++)y=.02+.06*float(i)'
	DB	',y-=w(m*y+v).x,x+=y*f,f*=.95;return clamp(1.-x,0.,1.);}vec3 i'
	DB	'(vec3 v,vec3 m){float f=.3*s(m.xy+9123.*m.z).x,i=-1.;for(int '
	DB	'r=0;r<128;r++){vec2 n=w(v+m*f);if(n.x<1e-4*f||f>50.)break;f+='
	DB	'.9*n.x;i=n.y;}vec3 r=vec3(.7,.9,1),z=normalize(vec3(-.4,.9,-.'
	DB	'6));if(i>-.5){x=1;vec3 d=v+f*m,l=e(d,m),n=reflect(m,l);r=vec3'
	DB	'(1);r=.5+.3*sin(vec3(.05,.08,.1)*(i-1.));if(i<.4)r=.15*c(d*ve'
	DB	'c3(.15,1.5,1.5));else if(i<.9)r=c((i==.8?d.zxy:i==.6?d.yzx:d)'
	DB	'*.5*vec3(1.5,.15,1.5));else if(i<1.5)r=a(d.zyx);else if(i==50'
	DB	'.5||i==50.)y=i==50.?d:y,r=mix(vec3(.01,.3,1),r,smoothstep(.5,'
	DB	'.6,p(y*2.,l))),l=s(y,l);l=s(30.*d,l);float t=clamp(dot(l,z),0'
	DB	'.,1.)*c(d,z);vec3 b=t*1.3*vec3(1,.8,.55)+pow(clamp(dot(n,z),0'
	DB	'.,1.),16.)*vec3(1,.9,.7)+h(d,l)*(.4*clamp(.5+.5*l.y,0.,1.)*ve'
	DB	'c3(.4,.6,1)+.5*smoothstep(-.1,.1,n.y)*vec3(.4,.6,1)+clamp(dot'
	DB	'(l,normalize(-vec3(z.x,0,z.z))),0.,1.)*clamp(1.-d.y,0.,1.)*.5'
	DB	'*vec3(.25)+.25*pow(clamp(1.+dot(l,m),0.,1.),2.));r=mix(r*b,ve'
	DB	'c3(.8,.9,1),smoothstep(10.,50.,f));}return vec3(clamp(r,0.,1.'
	DB	'));}void main(){float[18] x=float[18](0.,10.,10.,20.,20.,35.,'
	DB	'20.,40.,20.,47.,30.,55.,55.,65.,87.,1e2,1e2,120.);float[30] y'
	DB	'=float[30](162.,8.,-85.,162.,4.,-5.,112.,4.,-8.,92.,15.5,-7.,'
	DB	'94.,15.5,4.,10.,10.,5.,-10.,24.,8.,-23.,24.,9.,-6.,21.85,8.,8'
	DB	'4.,4.2,2.),c=float[30](162.,4.5,-30.,170.,4.5,-7.,120.,3.5,-7'
	DB	'.,90.,15.3,-5.,92.,14.,5.,0.,8.,5.,-20.,22.,5.,-20.5,22.,5.,-'
	DB	'10.,21.,5.,82.,4.,2.);float z,l=.5*cos(.2*v),r=smoothstep(110'
	DB	'.,130.,v);vec3 d=vec3(y[0],y[1],y[2]),n=vec3(c[0],c[1],c[2]);'
	DB	'for(int t=1;t<10;t++)z=smoothstep(x[t*2-2],x[t*2-1],v),d=mix('
	DB	'd,vec3(y[t*3],y[t*3+1],y[t*3+2]),z),n=mix(n,vec3(c[t*3],c[t*3'
	DB	'+1],c[t*3+2]),z);vec3 s=normalize(n-d),b=normalize(cross(s,ve'
	DB	'c3(sin(l),cos(l),0))),t=i(d,mat3(b,normalize(cross(b,s)),s)*n'
	DB	'ormalize(vec3(m.xy,2)));t=mix(t,vec3(.01,.3,1),.5*smoothstep('
	DB	'1.,1.3,p(2.5*m)+r));f=vec4(pow(clamp(t*(1.-r),0.,1.),vec3(.57'
	DB	')),1);}', 00H				; `string'
CONST	ENDS
_DATA	SEGMENT
?fsh@@3PBDB DD	FLAT:??_C@_0BOEF@ICOFMCO@?$CDversion?5430?6layout?$CIlocation?$DN0?$CJ@ ; fsh
_DATA	ENDS
;	COMDAT ??_C@_0KH@FAIDBDIH@?$CDversion?5430?6layout?$CIlocation?$DN0?$CJ@
CONST	SEGMENT
??_C@_0KH@FAIDBDIH@?$CDversion?5430?6layout?$CIlocation?$DN0?$CJ@ DB '#ve'
	DB	'rsion 430', 0aH, 'layout(location=0) in vec2 inVer;out vec2 p'
	DB	';out gl_PerVertex{vec4 gl_Position;};void main(){gl_Position='
	DB	'vec4(inVer,0.0,1.0);p=inVer*vec2(1280./720.,1.);}', 00H ; `string'
CONST	ENDS
PUBLIC	?intro_init@@YGHXZ				; intro_init
PUBLIC	?intro_do@@YGXJ@Z				; intro_do
PUBLIC	__real@408f400000000000
EXTRN	__imp__glRects@16:PROC
EXTRN	?myglfunc@@3PAPAXA:BYTE				; myglfunc
EXTRN	__fltused:DWORD
_BSS	SEGMENT
?fsid@@3HA DD	01H DUP (?)				; fsid
_BSS	ENDS
;	COMDAT __real@408f400000000000
CONST	SEGMENT
__real@408f400000000000 DQ 0408f400000000000r	; 1000
CONST	ENDS
_DATA	SEGMENT
?vsh@@3PBDB DD	FLAT:??_C@_0KH@FAIDBDIH@?$CDversion?5430?6layout?$CIlocation?$DN0?$CJ@ ; vsh
_DATA	ENDS
; Function compile flags: /Ogspy
; File C:\Users\sebastien.durand\source\Intro-4Kbyte-Kelenian\i4k_Bibli1\src\intro.cpp
;	COMDAT ?intro_do@@YGXJ@Z
_TEXT	SEGMENT
tv84 = 8						; size = 4
tv64 = 8						; size = 4
_time$ = 8						; size = 4
?intro_do@@YGXJ@Z PROC					; intro_do, COMDAT

; 37   : void intro_do(long time) {

	push	ebp
	mov	ebp, esp

; 38   :     oglProgramUniform1f(fsid, 0, ((float)time) / 1000.f);

	fild	DWORD PTR _time$[ebp]
	push	ecx
	fstp	DWORD PTR tv64[ebp]
	fld	DWORD PTR tv64[ebp]
	fdiv	QWORD PTR __real@408f400000000000
	fstp	DWORD PTR tv84[ebp]
	fld	DWORD PTR tv84[ebp]
	fstp	DWORD PTR [esp]
	push	0
	push	DWORD PTR ?fsid@@3HA
	call	DWORD PTR ?myglfunc@@3PAPAXA+16

; 39   : 	glRects(-1, -1, 1, 1); // Deprecated. Still seems to work though.

	push	1
	push	1
	push	-1
	push	-1
	call	DWORD PTR __imp__glRects@16

; 40   : }

	pop	ebp
	ret	4
?intro_do@@YGXJ@Z ENDP					; intro_do
_TEXT	ENDS
; Function compile flags: /Ogspy
; File C:\Users\sebastien.durand\source\Intro-4Kbyte-Kelenian\i4k_Bibli1\src\intro.cpp
;	COMDAT ?intro_init@@YGHXZ
_TEXT	SEGMENT
_pid$ = -4						; size = 4
?intro_init@@YGHXZ PROC					; intro_init, COMDAT

; 16   : {

	push	ebp
	mov	ebp, esp
	push	ecx
	push	esi
	push	edi

; 17   :     int vsid = oglCreateShaderProgramv(GL_VERTEX_SHADER, 1, &vsh);

	push	OFFSET ?vsh@@3PBDB
	xor	edi, edi
	inc	edi
	push	edi
	push	35633					; 00008b31H
	call	DWORD PTR ?myglfunc@@3PAPAXA

; 18   :     fsid = oglCreateShaderProgramv(GL_FRAGMENT_SHADER, 1, &fsh);

	push	OFFSET ?fsh@@3PBDB			; fsh
	push	edi
	push	35632					; 00008b30H
	mov	esi, eax
	call	DWORD PTR ?myglfunc@@3PAPAXA
	mov	DWORD PTR ?fsid@@3HA, eax

; 19   : 
; 20   :     unsigned int pid;
; 21   :     oglGenProgramPipelines(1, &pid);

	lea	eax, DWORD PTR _pid$[ebp]
	push	eax
	push	edi
	call	DWORD PTR ?myglfunc@@3PAPAXA+4

; 22   :     oglBindProgramPipeline(pid);

	push	DWORD PTR _pid$[ebp]
	call	DWORD PTR ?myglfunc@@3PAPAXA+8

; 23   :     oglUseProgramStages(pid, GL_VERTEX_SHADER_BIT, vsid);

	push	esi
	push	edi
	push	DWORD PTR _pid$[ebp]
	call	DWORD PTR ?myglfunc@@3PAPAXA+12

; 24   :     oglUseProgramStages(pid, GL_FRAGMENT_SHADER_BIT, fsid);

	push	DWORD PTR ?fsid@@3HA
	push	2
	push	DWORD PTR _pid$[ebp]
	call	DWORD PTR ?myglfunc@@3PAPAXA+12

; 25   : 
; 26   : #ifdef DEBUG
; 27   :     int		result;
; 28   :     char    info[1536];
; 29   :     oglGetProgramiv(vsid, GL_LINK_STATUS, &result); oglGetProgramInfoLog(vsid, 1024, NULL, (char*)info);  if (!result) DebugBreak();
; 30   :     oglGetProgramiv(fsid, GL_LINK_STATUS, &result); oglGetProgramInfoLog(fsid, 1024, NULL, (char*)info); if (!result) DebugBreak();
; 31   :     oglGetProgramiv(pid, GL_LINK_STATUS, &result); oglGetProgramInfoLog(pid, 1024, NULL, (char*)info); if (!result) DebugBreak();
; 32   : #endif
; 33   : 
; 34   :     return 1;

	mov	eax, edi
	pop	edi
	pop	esi

; 35   : }

	leave
	ret	0
?intro_init@@YGHXZ ENDP					; intro_init
_TEXT	ENDS
END
