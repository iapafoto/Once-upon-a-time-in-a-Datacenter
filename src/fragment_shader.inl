/* File generated with Shader Minifier 1.1.4
 * http://www.ctrl-alt-test.fr
 */
#ifndef FRAGMENT_SHADER_INL_
#define FRAGMENT_SHADER_INL_

const char* fsh =
"#version 430\n"
//"float y=0.;vec3 z=vec3(0);int b=0;float Z(vec3 v,vec3 x,float z){x=abs(v)-x;return min(max(x.x,max(x.y,x.z)),0.)+length(max(x,0.))-y*z;}vec2 s(vec2 v){v=fract(v*vec2(5.398,5.443));v+=dot(v.yx,v+vec2(21.535,14.3137));return fract(v.x*v.y*vec2(95.434,97.597));}float t(vec2 v){vec2 x=floor(v);v-=x;v*=v*v*(v*v*6.-v*15.+10.);return dot(mat2(fract(sin(mod(vec4(0,1,113,114)+dot(x,vec2(1,113)),6.2832))*43758.5))*vec2(1.-v.y,v.y),vec2(1.-v.x,v));}float p(vec2 v){return t(v)*.533+t(v*2.)*.267+t(v*4.)*.133+t(v*8.)*.067;}float p(vec3 v,vec3 x){x=max(x*x,.001);x/=x.x+x.y+x.z;return p(v.yz)*x.x+p(v.zx)*x.y+p(v.xy)*x.z;}vec3 s(vec3 v,vec3 x){v=(vec3(p(vec3(v.x-.001,v.yz),x),p(vec3(v.x,v.y-.001,v.z),x),p(vec3(v.xy,v.z-.001),x))-p(v,x))/.002;return normalize(x+(v-x*dot(x,v))*.2);}mat2 n(float v){float x=cos(v),y=sin(v);return mat2(x,y,-y,x);}vec3 d(vec3 v){vec3 x=v;v=sin(v*4.3+cos(v.yzx*6.7));float y=dot(v+sin(v*13.)*.03,vec3(3)),b=1.-abs(dot(sin(x*120.5+y*6.283+sin(x.zxy*121.3)),vec3(.333)));y=fract(y+fract(y*4.)*.1);y=min(min(y,y*(1.-y)*6.)*.85+b*.2,1.);return.3+.7*sqrt(mix(vec3(.5,.15,.025),vec3(.75,.3,.1)*2.,y*.75+.25))*(y*.6+.4);}vec3 f(vec3 v){vec2 x=vec2(6,.8),m;v.z+=mod(round(v.x/.8),2.)*3.;m=x*round(v.zx/x);float y=s((m+120.)*80.).x;v.zx-=m;return d((v+y)*.7*vec3(1,1,.1))*mix(.1,1.,smoothstep(0.,-.02,V(vec3(v.zx,0),x.x*.5,x.y*.5,49,0.)))*mix(.5,1.,y);}vec2 d(vec2 x,vec2 v){return x.x<v.x?x:v;}vec2 d(vec3 v,vec3 x,vec3 y,vec3 m){x-=v;y-=v;m-=v;vec3 n=cross(x,y),b=cross(y,m),z=cross(m,x),f=n+b+z;float r,c=-dot(z,f),d=-dot(n,f),s=-dot(b,f);v=(s-d)*y+(d+c*.5)*m-(s+c*.5)*x;r=clamp((c*.5+d-.5*(c*c*.25-d*s)*dot(v,x-2.*y+m)/dot(v,v))/-dot(f,f),0.,1.);return vec2(length(mix(mix(x,y,r),mix(y,m,r),r)),r);}vec2 c(vec3 x){float m=length(x),f=smoothstep(89.,103.,v),r;if(m>3.1&&b==0)return vec2(m-3.,10);vec3 c=x;m=V(c,.3,.6,.2,.1+.1*c.y);vec2 s=d(c,vec3(0,.6,0),vec3(0,1.1,-.4),vec3(0,1.6,.2));c.x=abs(c.x);c.xz*=n(-.2);m=min(m,W(c,.4,-1.8,1.3,.2,.12,.4,0.));s=d(s,d(c,vec3(.2,-.6,0),vec3(.6,-.3,1.5),vec3(.4,-1.8,1)));s=d(s,d(c,vec3(.3+.2*y,.6,0),vec3(.9,-.3,-.5),vec3(.8,0,1.3)));s+=vec2(-.08,cos(60.*s.y)>.6?50.:25.);c=x-vec3(0,1.9,.5);c.xy*=n(.4*f-.2);c.zy*=n(smoothstep(80.,84.,v)-.5-.5*f);c.xz*=n(-1.6*f);z=c;s=d(s,vec2(V(c,.9,.6,.5,0.),50.5));c.x=abs(c.x);s=d(s,vec2(length(c-vec3(.75,0,0))-.3,25));r=length(c-vec3(.3,-.05,.25))-.3;c=x+vec3(0,0,-1.4);c.yz*=n(-.7);if(v<79.)x=c,x.xy*=n(1.66),x.y=abs(x.y),x.xy*=n(1.26),x.x-=.5+x.y*1.256,x.y-=.12,f=min(V(x,.5,0,.75,.018),W(x,-.65,.02,-.02,.12,0,.68,.018)),x.y-=.01+sin(x.x*6.9+5.7)*.027/(1.+x.x)-.12,s=d(s,d(vec2(f,70),vec2(.7*V(x,.48,.06,.73,0.),2)));c.x=abs(c.x);c.xy*=n(.2);return d(d(s,vec2(min(m,W(c,1,-.05,0,.2,.15,.2,.05)),50)),vec2(r,-1));}vec2 c(vec3 v,float x,float c,float m,vec3 s){v-=vec3(-x*.5,c,0);v.xy*=n(y*(.01*m-.02));return d(vec2(V(v,x*.45-.01,c-.01,c*.6,0.),15),vec2(max(V(v,x*.45-.03,c,c*.66,.03),-W(v,0,-.2,.05,x*.45-.06,c+.5,c*.66+.03,.03)),52.+50.*cos(112.*(5.*s.z+10.*m+11.*s.y+5.*cos(s.x)))));}vec2 r(vec3 x){vec3 m,f=x,b=x,r=x-vec3(-20,19.65,3);r.xz*=n(.4);vec2 i=vec2(999,0),z=c(r);float p,e=W(x,5,30,5,15,30,5,0.),l=length(r),B=max(0.,v-80.);l-=5.*smoothstep(0.,18.,B)+5.1*max(0.,B-18.5);y=smoothstep(-1.,1.,l);f.y=mod(f.y+10.,17.5)-10.;i=d(i,vec2(max(-e,W(f,0,.1,0,999,.1,999,0.)),1));m=x-vec3(6.7,0,5);m.xy*=n(.785);m.z=abs(m.z);p=W(m,0,0,3,1.2,24,.05,0.);m.y-=clamp(round(m.y),0.,24.);m.yx*=n(.785);i=d(i,vec2(min(p,V(m,.45,.5,3,.05)),.37));f.x=mod(f.x+1.5,3.)-1.5;i=d(i,vec2(max(-e,W(f,0,-.5,0,.17,.45,999,0.)),.3));f=x-vec3(10,0,-2.5);f.xz=mod(f.xz+36.,72.)-36.;f.zy*=n(-.2);f.x-=18.;m=f;m.y-=clamp(round(m.y),0.,9.);m.x-=clamp(m.x,-.8,.8);f.x=abs(f.x)-.75;f.y-=clamp(f.y,0.,10.);i=d(i,vec2(min(length(m)-.07,length(f)-.1),.3));x.z=mod(x.z+5.,10.)-5.;r=x;vec2 t,a,G=y*(.2+.1*cos(2.*r.xy)+.2*cos(.3*r.xy));z=d(z,vec2(W(r,0,15.8,0,999,.85-G.x,.65-G.x,G.x),.8));r.z=abs(r.z)-1.1;r.x=mod(r.x+6.,12.)-6.;z=d(z,vec2(V(r,.5-G.y,100,.5-G.y,G.y),.5));z=d(z,vec2(V(r,.5,.3,.5,.1+.05*cos(6.*r.y)),8.5));z=d(z,vec2(W(r,0,16.8,0,.45,.45,1e3,.2),.6));z=d(z,vec2(W(r,0,14.7,0,.7,0,0,.05),.3));i=d(i,vec2(W(r,0,14.7,-.5,.2,.27,.6,.05),.5));r-=vec3(0,15.5,1.7);r.zy*=n(.72);i=d(i,vec2(V(r,.17,.2,2.6,.1),.5));r.z=abs(r.z);i=d(i,vec2(W(r,0,0,2,.7,0,0,.05),.3));r=x;r.z-=2.5;r.x=mod(r.x+30.,48.)-11.;r.y=mod(r.y+13.,17.5)-13.;z=d(z,vec2(W(r,0,1.4,0,2.4,0,.8,.1),.3));r.xz=abs(r.xz);r.xy*=n(.1);i=d(i,vec2(W(r,1.6,.6,.6,0,.7,0,.1),4.5));r=x;r.x=mod(r.x+36.,72.)-36.;e=min(W(r,18,0,0,6.01,999,999,0.),W(b,0,15.25,0,999,2.2,999,0.));r=x;r.y=mod(r.y+.3,2.5)-1.25;z=d(z,vec2(max(-e,V(r,1e3,.1,.7,0.)),.8));r=x;r.y=mod(r.y-.5,2.5)-.5;p=.04;float k=floor(r.x),E=floor(x.y/2.5),D=y*.25*smoothstep(45.,90.,v);t=vec2(999,0);if(y<.5||v<77.){t=vec2(r.x-k>.5?W(r,k+11.5,.7,0,10.485,.7,.462,0.):W(r,k-10.5,.7,0,10.485,.7,.462,0.),0);r.x-=k;for(float o=0.;o<7.;o++){a=vec2(.1+.2*(1.-y),.5)+y*vec2(.1,.2)*s(vec2(o,k+10.*E));if(p+a.x>=.98)break;p+=a.x;if(a.x>D)t=d(t,c(r-vec3(p,0,0),a.x,a.y,o,vec3(k,E,floor(b.z+.5))));}t.x=max(t.x,-e);t.x=y<.5?max(t.x,l+.5):t.x;}i.x=max(i.x,-l);return d(i,d(z,t));}vec3 c(vec3 x,vec3 m){float c=0.,i=1.,e=.02,t,n,a=.3*s(m.xy+912.*m.z).x;vec2 l;for(int o=0;o<128;o++){l=r(x+m*a);if(l.x<1e-4*a||a>50.)break;a+=.9*l.x;}n=l.y;if(n<-.5)return vec3(.7,.9,1);x+=a*m;vec3 o,G,k,B=vec3(0,2.*max(8e-5*a,.015),0);k=vec3(r(x-B.yxx).x,r(x-B.xyx).x,r(x-B.xxy));o=vec3(r(x+B.yxx).x,r(x+B.xyx).x,r(x+B.xxy));B=o-k;B=normalize(B-max(0.,dot(B,m))*m);G=reflect(m,B);o=15.*abs(l.x-.5*(o+k));t=min(1.,o.x+o.y+o.z);o=.5+.3*sin(vec3(.05,.08,.1)*(n-1.));if(n<.4)o=.15*d(x*vec3(.15,1.5,1.5));else if(n<.9)o=d((n==.8?x.zxy:n==.6?x.yzx:x)*.5*vec3(1.5,.15,1.5));else if(n<1.5)o=f(x.zyx);else if(n==50.5||n==50.)o=mix(vec3(.01,.3,1),o,smoothstep(.5,.6,p((n==50.?x:z)*2.,B)));B=y>0.?s(30.*x,B):B;k=vec3(-.347,.78,-.52),b=1;for(int D=0;D<24;D++){n=r(x+k*e).x;i=min(i,2.*n/e);e+=clamp(n,.02,.1);if(n<.001||e>2.5)break;}e=1.05;for(int D=0;D<5;D++)n=.02+.06*float(D),n-=r(x+B*n).x,c+=n*(e*=.95);k=clamp(dot(B,k),0.,1.)*clamp(i,0.,1.)*vec3(1.3,1,.7)+pow(clamp(dot(G,k),0.,1.),16.)*vec3(1,.9,.7)+clamp(1.-c,0.,1.)*((.4*clamp(.5+.5*B.y,0.,1.)+.5*smoothstep(-.1,.1,G.y))*vec3(.4,.6,1)+.25*pow(clamp(1.+dot(B,m),0.,1.),2.));return mix(mix(.2+t*(2.+cos(3.*v))*vec3(.1,1,2),o,y)*k,vec3(.8,.9,1),smoothstep(10.,50.,a));}void main(){int[18] r=int[18](0,10,10,20,20,35,20,40,20,47,30,55,55,65,92,99,99,120);int[30] f=int[30](162,8,-85,162,4,-5,112,4,-8,92,16,-7,94,15,4,10,10,5,-10,24,8,-23,24,9,-4,25,7,90,1,4),y=int[30](162,4,-30,170,5,-7,120,3,-7,90,15,-5,92,14,5,0,8,5,-20,22,5,-20,22,5,-10,21,5,84,5,8);float z;vec3 i,n=vec3(f[0],f[1],f[2]),B=vec3(y[0],y[1],y[2]);for(int o=0;o<9;o++)z=smoothstep(float(r[o*2]),float(r[o*2+1]),v),n=mix(n,vec3(f[o*3+3],f[o*3+4],f[o*3+5]),z),B=mix(B,vec3(y[o*3+3],y[o*3+4],y[o*3+5]),z);z=.5*cos(.2*v);i=normalize(B-n);B=normalize(cross(i,vec3(sin(z),cos(z),0)));B=mat3(B,normalize(cross(B,i)),i)*normalize(vec3(m.xy,2));i=c(n,B);z=smoothstep(115.,125.,v);x=vec4(pow(clamp(mix(i,vec3(.1,1,2),.5*smoothstep(1.,1.3,p(2.5*m)+z))*(1.-z),0.,1.),vec3(.57)),1);}";
//"layout(location=0) uniform float v;layout(location=0) out vec4 x;in vec2 m;\n#define V(p,bx,by,bz,e)a(p,vec3(bx,by,bz),e)\n#define a(p,x,y,z,bx,by,bz,e)a(p-vec3(x,y,z),vec3(bx,by,bz),e)\nfloat y=0.;vec3 z=vec3(0);int b=0;float Z(vec3 x,vec3 v,float z){v=abs(x)-v;return min(max(v.x,max(v.y,v.z)),0.)+length(max(v,0.))-y*z;}vec2 s(vec2 v){v=fract(v*vec2(5.398,5.443));v+=dot(v.yx,v+vec2(21.535,14.3137));return fract(v.x*v.y*vec2(95.434,97.597));}float t(vec2 v){vec2 m=floor(v);v-=m;v*=v*v*(v*v*6.-v*15.+10.);return dot(mat2(fract(sin(mod(vec4(0,1,113,114)+dot(m,vec2(1,113)),6.2832))*43758.5))*vec2(1.-v.y,v.y),vec2(1.-v.x,v));}float n(vec2 v){return t(v)*.533+t(v*2.)*.267+t(v*4.)*.133+t(v*8.)*.067;}float n(vec3 v,vec3 x){x=max(x*x,.001);x/=x.x+x.y+x.z;return n(v.yz)*x.x+n(v.zx)*x.y+n(v.xy)*x.z;}vec3 s(vec3 v,vec3 y){v=(vec3(n(vec3(v.x-.001,v.yz),y),n(vec3(v.x,v.y-.001,v.z),y),n(vec3(v.xy,v.z-.001),y))-n(v,y))/.002;return normalize(y+(v-y*dot(y,v))*.1);}mat2 p(float v){float x=cos(v),y=sin(v);return mat2(x,y,-y,x);}vec3 d(vec3 v){vec3 x=v;v=sin(v*4.3+cos(v.yzx*6.7));float y=dot(v+sin(v*13.)*.03,vec3(3)),b=1.-abs(dot(sin(x*120.5+y*6.283+sin(x.zxy*121.3)),vec3(.333)));y=fract(y+fract(y*4.)*.1);y=min(min(y,y*(1.-y)*6.)*.85+b*.2,1.);return.3+.7*sqrt(mix(vec3(.5,.15,.025),vec3(.75,.3,.1)*2.,y*.75+.25))*(y*.6+.4);}vec3 f(vec3 v){vec2 y=vec2(6,.8),m;v.z+=mod(round(v.x/.8),2.)*3.;m=y*round(v.zx/y);float x=s((m+120.)*80.).x;v.zx-=m;return d((v+x)*.7*vec3(1,1,.1))*mix(.1,1.,smoothstep(0.,-.02,V(vec3(v.zx,0),y.x*.5,y.y*.5,49,0.)))*mix(.5,1.,x);}vec2 d(vec2 v,vec2 x){return v.x<x.x?v:x;}vec2 d(vec3 v,vec3 x,vec3 y,vec3 m){x-=v;y-=v;m-=v;vec3 p=cross(x,y),b=cross(y,m),c=cross(m,x),z=p+b+c;float f,s=-dot(c,z),e=-dot(p,z),d=-dot(b,z);v=(d-e)*y+(e+s*.5)*m-(d+s*.5)*x;f=clamp((s*.5+e-.5*(s*s*.25-e*d)*dot(v,x-2.*y+m)/dot(v,v))/-dot(z,z),0.,1.);return vec2(length(mix(mix(x,y,f),mix(y,m,f),f)),f);}vec2 a(vec3 x){float m=length(x),c=smoothstep(89.,103.,v),f;if(m>3.1&&b==0)return vec2(m-3.,10);vec3 i=x;m=V(i,.3,.6,.2,.1+.1*i.y);vec2 s=d(i,vec3(0,.6,0),vec3(0,1.1,-.4),vec3(0,1.6,.2));i.x=abs(i.x);i.xz*=p(-.2);m=min(m,W(i,.4,-1.8,1.3,.2,.12,.4,0.));s=d(s,d(i,vec3(.2,-.6,0),vec3(.6,-.3,1.5),vec3(.4,-1.8,1)));s=d(s,d(i,vec3(.3+.2*y,.6,0),vec3(.9,-.3,-.5),vec3(.8,0,1.3)));s+=vec2(-.08,cos(60.*s.y)>.6?50.:25.);i=x-vec3(0,1.9,.5);i.xy*=p(.4*c-.2);i.zy*=p(smoothstep(80.,84.,v)-.5-.5*c);i.xz*=p(-1.6*c);z=i;s=d(s,vec2(V(i,.9,.6,.5,0.),50.5));i.x=abs(i.x);s=d(s,vec2(length(i-vec3(.75,0,0))-.3,25));f=length(i-vec3(.3,-.05,.25))-.3;i=x+vec3(0,0,-1.4);i.yz*=p(-.7);if(v<79.)x=i,x.xy*=p(1.66),x.y=abs(x.y),x.xy*=p(1.26),x.x-=.5+x.y*1.256,x.y-=.12,c=min(V(x,.5,0,.75,.018),W(x,-.65,.02,-.02,.12,0,.68,.018)),x.y-=.01+sin(x.x*6.9+5.7)*.027/(1.+x.x)-.12,s=d(s,d(vec2(c,70),vec2(.7*V(x,.48,.06,.73,0.),2)));i.x=abs(i.x);i.xy*=p(.2);return d(d(s,vec2(min(m,W(i,1,-.05,0,.2,.15,.2,.05)),50)),vec2(f,-1));}vec2 a(vec3 v,float x,float z,float f){v.xy*=p(y*(.05-.2*x));v-=vec3(-x*.5,z+.07,0);x=x*.5-.03;v.x=abs(v.x);float m=W(v,x,0,0,0,z,z*.7,.01);v.z+=.03*cos(v.x/x)-.01;return d(vec2(W(v,0,0,-.015,x,z*.95+.002*cos(6e2*v.x),z*.65,0.),15),vec2(min(m,W(v,0,0,-z*.7-.01+.02*(.3+cos(2.*max(.9,cos(14.*v.y/z)))),x-.015,z,0,.015)),f));}vec2 c(vec3 x){vec3 i,m=x,z=x,f=x-vec3(-20,19.65,3);f.xz*=p(.4);vec2 r=vec2(999,0),c=a(f);float b,e=W(x,5,30,5,15,30,5,0.),n=length(f),l=max(0.,v-80.);n-=5.*smoothstep(0.,18.,l)+5.1*max(0.,l-18.5);y=smoothstep(-1.,1.,n);m.y=mod(m.y+10.,17.5)-10.;r=d(r,vec2(max(-e,W(m,0,.1,0,999,.1,999,0.)),1));i=x-vec3(6.7,0,5);i.xy*=p(.785);i.z=abs(i.z);b=W(i,0,0,3,1.2,24,.05,0.);i.y-=clamp(round(i.y),0.,24.);i.yx*=p(.785);r=d(r,vec2(min(b,V(i,.45,.5,3,.05)),.37));m.x=mod(m.x+1.5,3.)-1.5;r=d(r,vec2(max(-e,W(m,0,-.5,0,.17,.45,999,0.)),.3));m=x-vec3(10,0,-2.5);m.xz=mod(m.xz+36.,72.)-36.;m.zy*=p(-.2);m.x-=18.;i=m;i.y-=clamp(round(i.y),0.,9.);i.x-=clamp(i.x,-.8,.8);m.x=abs(m.x)-.75;m.y-=clamp(m.y,0.,10.);r=d(r,vec2(min(length(i)-.07,length(m)-.1),.3));x.z=mod(x.z+5.,10.)-5.;f=x;vec2 t,B=y*(.2+.1*cos(2.*f.xy)+.2*cos(.3*f.xy));c=d(c,vec2(W(f,0,15.8,0,999,.85-B.x,.65-B.x,B.x),.8));f.z=abs(f.z)-1.1;f.x=mod(f.x+6.,12.)-6.;c=d(c,vec2(V(f,.5-B.y,100,.5-B.y,B.y),.5));c=d(c,vec2(V(f,.5,.3,.5,.1+.05*cos(6.*f.y)),8.5));c=d(c,vec2(W(f,0,16.8,0,.45,.45,1e3,.2),.6));c=d(c,vec2(W(f,0,14.7,0,.7,0,0,.05),.3));r=d(r,vec2(W(f,0,14.7,-.5,.2,.27,.6,.05),.5));f-=vec3(0,15.5,1.7);f.zy*=p(.72);r=d(r,vec2(V(f,.17,.2,2.6,.1),.5));f.z=abs(f.z);r=d(r,vec2(W(f,0,0,2,.7,0,0,.05),.3));f=x;f.z-=2.5;f.x=mod(f.x+30.,48.)-11.;f.y=mod(f.y+13.,17.5)-13.;c=d(c,vec2(W(f,0,1.4,0,2.4,0,.8,.1),.3));f.xz=abs(f.xz);f.xy*=p(.1);r=d(r,vec2(W(f,1.6,.6,.6,0,.7,0,.1),4.5));f=x;f.x=mod(f.x+36.,72.)-36.;e=min(W(f,18,0,0,6.01,999,999,0.),W(z,0,15.25,0,999,2.2,999,0.));f=x;f.y=mod(f.y+.3,2.5)-1.25;c=d(c,vec2(max(-e,V(f,1e3,.1,.7,0.)),.8));f=x;f.y=mod(f.y-.5,2.5)-.5;float k=floor(f.x),F=floor(x.y/2.5),E=y*.5*smoothstep(65.,88.,v);t=vec2(999,0);if(y<.5||v<77.){t=vec2(f.x-k>.5?W(f,k+11.5,.75,0,10.485,.8,.462,0.):W(f,k-10.5,.8,0,10.485,.75,.462,0.),0);f.x-=k;for(float o=0.;o<=.98;){B=vec2(.1+.4*(1.-y),.4)+y*vec2(.2)*s(vec2(o,k+F));B.x=min(B.x,1.-o);o+=B.x;if(B.x>E)t=d(t,a(f-vec3(o,0,0),B.x,B.y,2.+250.*s(B+k).x));}t.x=max(t.x,-e);t.x=y<.5?max(t.x,n+.5):t.x;}r.x=max(r.x,-n);return d(r,d(c,t));}vec3 a(vec3 x,vec3 m){float i=0.,r=1.,e=.02,t,p,a=.3*s(m.xy+912.*m.z).x;vec2 B;for(int o=0;o<128;o++){B=c(x+m*a);if(B.x<1e-4*a||a>50.)break;a+=.9*B.x;}p=B.y;if(p<-.5)return vec3(.7,.9,1);x+=a*m;vec3 l,o,k,F=vec3(0,max(8e-4*a,.03-y*.02),0);k=vec3(c(x-F.yxx).x,c(x-F.xyx).x,c(x-F.xxy));l=vec3(c(x+F.yxx).x,c(x+F.xyx).x,c(x+F.xxy));F=l-k;F=normalize(F-max(0.,dot(F,m))*m);o=reflect(m,F);l=15.*abs(B.x-.5*(l+k));t=min(1.,l.x+l.y+l.z);l=.5+.3*sin(vec3(.05,.08,.1)*(p-1.));if(p<.4)l=.15*d(x*vec3(.15,1.5,1.5));else if(p<.9)l=d((p==.8?x.zxy:p==.6?x.yzx:x)*.5*vec3(1.5,.15,1.5));else if(p<1.5)l=f(x.zyx);else if(p==50.5||p==50.)l=mix(vec3(.01,.3,1),l,smoothstep(.5,.6,n((p==50.?x:z)*2.,F)));F=y>0.?s(30.*x,F):F;k=normalize(vec3(.347,.78,-.752)),b=1;for(int E=0;E<24;E++){p=c(x+k*e).x;r=min(r,2.*p/e);e+=clamp(p,.02,.1);if(p<.001||e>2.5)break;}e=1.05;for(int E=0;E<5;E++)p=.02+.06*float(E),p-=c(x+F*p).x,i+=p*(e*=.95);k=dot(F,k)*clamp(r,0.,1.)*vec3(1.3,1,.7)+4.*pow(clamp(dot(o,k),0.,1.),46.)*vec3(1,.9,.7)+clamp(1.-i,0.,1.)*(.4*clamp(.5+.5*F.y,0.,1.)+.5*smoothstep(-.1,.1,o.y))*vec3(.4,.6,1)+.25*pow(clamp(1.+dot(F,m),0.,1.),2.);return mix(mix(.2+t*(2.+cos(3.*v))*vec3(.1,1,2),l,y)*k,vec3(.8,.9,1),smoothstep(10.,50.,a));}void main(){int[18] f=int[18](0,10,10,20,20,35,20,40,20,47,30,55,55,65,92,99,99,120);int[30] y=int[30](162,8,-85,162,4,-5,112,4,-8,92,16,-7,94,15,4,10,10,5,-10,24,8,-23,24,9,-4,25,7,90,1,4),c=int[30](162,4,-30,170,5,-7,120,3,-7,90,15,-5,92,14,5,0,8,5,-20,22,5,-20,22,5,-10,21,5,84,5,8);float i;vec3 z,r=vec3(y[0],y[1],y[2]),p=vec3(c[0],c[1],c[2]);for(int o=0;o<9;o++)i=smoothstep(float(f[o*2]),float(f[o*2+1]),v),r=mix(r,vec3(y[o*3+3],y[o*3+4],y[o*3+5]),i),p=mix(p,vec3(c[o*3+3],c[o*3+4],c[o*3+5]),i);i=.5*cos(.2*v);z=normalize(p-r);p=normalize(cross(z,vec3(sin(i),cos(i),0)));p=mat3(p,normalize(cross(p,z)),z)*normalize(vec3(m.xy,2));z=a(r,p);i=smoothstep(115.,125.,v);x=vec4(pow(clamp(mix(z,vec3(.1,1,2),.5*smoothstep(1.,1.3,n(2.5*m)+i))*(1.-i),0.,1.),vec3(.57)),1);}";
"layout(location=0) uniform float v;layout(location=0) out vec4 x;in vec2 m;\n#define V(p,bx,by,bz,e)a(p,vec3(bx,by,bz),e)\n#define W(p,x,y,z,bx,by,bz,e)a(p-vec3(x,y,z),vec3(bx,by,bz),e)\nfloat y=0.;vec3 z=vec3(0);int b=0;float a(vec3 v,vec3 x,float z){x=abs(v)-x;return min(max(x.x,max(x.y,x.z)),0.)+length(max(x,0.))-y*z;}vec2 s(vec2 v){v=fract(v*vec2(5.398,5.443));v+=dot(v.yx,v+vec2(21.535,14.3137));return fract(v.x*v.y*vec2(95.434,97.597));}float t(vec2 v){vec2 x=floor(v);v-=x;v*=v*v*(v*v*6.-v*15.+10.);return dot(mat2(fract(sin(mod(vec4(0,1,113,114)+dot(x,vec2(1,113)),6.2832))*43758.5))*vec2(1.-v.y,v.y),vec2(1.-v.x,v));}float n(vec2 v){return t(v)*.533+t(v*2.)*.267+t(v*4.)*.133+t(v*8.)*.067;}float n(vec3 v,vec3 x){x=max(x*x,.001);x/=x.x+x.y+x.z;return n(v.yz)*x.x+n(v.zx)*x.y+n(v.xy)*x.z;}vec3 s(vec3 v,vec3 x){v=(vec3(n(vec3(v.x-.001,v.yz),x),n(vec3(v.x,v.y-.001,v.z),x),n(vec3(v.xy,v.z-.001),x))-n(v,x))/.002;return normalize(x+(v-x*dot(x,v))*.1);}mat2 p(float v){float x=cos(v),y=sin(v);return mat2(x,y,-y,x);}vec3 d(vec3 v){vec3 x=v;v=sin(v*4.3+cos(v.yzx*6.7));float y=dot(v+sin(v*13.)*.03,vec3(3)),b=1.-abs(dot(sin(x*120.5+y*6.283+sin(x.zxy*121.3)),vec3(.333)));y=fract(y+fract(y*4.)*.1);y=min(min(y,y*(1.-y)*6.)*.85+b*.2,1.);return.3+.7*sqrt(mix(vec3(.5,.15,.025),vec3(.75,.3,.1)*2.,y*.75+.25))*(y*.6+.4);}vec3 f(vec3 v){vec2 x=vec2(6,.8),m;v.z+=mod(round(v.x/.8),2.)*3.;m=x*round(v.zx/x);float y=s((m+120.)*80.).x;v.zx-=m;return d((v+y)*.7*vec3(1,1,.1))*mix(.1,1.,smoothstep(0.,-.02,V(vec3(v.zx,0),x.x*.5,x.y*.5,49,0.)))*mix(.5,1.,y);}vec2 d(vec2 x,vec2 v){return x.x<v.x?x:v;}vec2 d(vec3 v,vec3 x,vec3 y,vec3 m){x-=v;y-=v;m-=v;vec3 p=cross(x,y),b=cross(y,m),c=cross(m,x),z=p+b+c;float f,s=-dot(c,z),e=-dot(p,z),d=-dot(b,z);v=(d-e)*y+(e+s*.5)*m-(d+s*.5)*x;f=clamp((s*.5+e-.5*(s*s*.25-e*d)*dot(v,x-2.*y+m)/dot(v,v))/-dot(z,z),0.,1.);return vec2(length(mix(mix(x,y,f),mix(y,m,f),f)),f);}vec2 a(vec3 x){float m=length(x),c=smoothstep(89.,103.,v),f;if(m>3.1&&b==0)return vec2(m-3.,10);vec3 s=x;m=V(s,.3,.6,.2,.1+.1*s.y);vec2 i=d(s,vec3(0,.6,0),vec3(0,1.1,-.4),vec3(0,1.6,.2));s.x=abs(s.x);s.xz*=p(-.2);m=min(m,W(s,.4,-1.8,1.3,.2,.12,.4,0.));i=d(i,d(s,vec3(.2,-.6,0),vec3(.6,-.3,1.5),vec3(.4,-1.8,1)));i=d(i,d(s,vec3(.3+.2*y,.6,0),vec3(.9,-.3,-.5),vec3(.8,0,1.3)));i+=vec2(-.08,cos(60.*i.y)>.6?50.:25.);s=x-vec3(0,1.9,.5);s.xy*=p(.4*c-.2);s.zy*=p(smoothstep(80.,84.,v)-.5-.5*c);s.xz*=p(-1.6*c);z=s;i=d(i,vec2(V(s,.9,.6,.5,0.),50.5));s.x=abs(s.x);i=d(i,vec2(length(s-vec3(.75,0,0))-.3,25));f=length(s-vec3(.3,-.05,.25))-.3;s=x+vec3(0,0,-1.4);s.yz*=p(-.7);if(v<79.)x=s,x.xy*=p(1.66),x.y=abs(x.y),x.xy*=p(1.26),x.x-=.5+x.y*1.256,x.y-=.12,c=min(V(x,.5,0,.75,.018),W(x,-.65,.02,-.02,.12,0,.68,.018)),x.y-=.01+sin(x.x*6.9+5.7)*.027/(1.+x.x)-.12,i=d(i,d(vec2(c,70),vec2(.7*V(x,.48,.06,.73,0.),2)));s.x=abs(s.x);s.xy*=p(.2);return d(d(i,vec2(min(m,W(s,1,-.05,0,.2,.15,.2,.05)),50)),vec2(f,-1));}vec2 a(vec3 v,float x,float z,float f){v.xy*=p(y*(.05-.2*x));v-=vec3(-x*.5,z+.07,0);x=x*.5-.03;v.x=abs(v.x);float m=W(v,x,0,0,0,z,z*.7,.01);v.z+=.03*cos(v.x/x)-.01;return d(vec2(W(v,0,0,-.015,x,z*.95+.002*cos(6e2*v.x),z*.65,0.),15),vec2(min(m,W(v,0,0,-z*.7-.01+.02*(.3+cos(2.*max(.9,cos(14.*v.y/z)))),x-.015,z,0,.015)),f));}vec2 c(vec3 x){vec3 m=x,z=x-vec3(-20,19.65,3);z.xz*=p(.4);vec2 i=vec2(999,0),f=a(z);float c=W(x,5,30,5,15,30,5,0.),e=length(z),b=max(0.,v-80.);e-=5.*smoothstep(0.,18.,b)+5.1*max(0.,b-18.5);y=smoothstep(-1.,1.,e);m.y=mod(m.y+10.,17.5)-10.;i=d(i,vec2(max(-c,W(m,0,.1,0,999,.1,999,0.)),1));z=x-vec3(6.7,0,5);z.xy*=p(.785);z.z=abs(z.z);b=W(z,0,0,3,1.2,24,.05,0.);z.y-=clamp(round(z.y),0.,24.);z.yx*=p(.785);i=d(i,vec2(min(b,V(z,.45,.5,3,.05)),.37));m.x=mod(m.x+1.5,3.)-1.5;i=d(i,vec2(max(-c,W(m,0,-.5,0,.17,.45,999,0.)),.3));m=x-vec3(10,0,-2.5);m.xz=mod(m.xz+36.,72.)-36.;m.zy*=p(-.2);m.x-=18.;z=m;z.y-=clamp(round(z.y),0.,9.);z.x-=clamp(z.x,-.8,.8);m.x=abs(m.x)-.75;m.y-=clamp(m.y,0.,10.);i=d(i,vec2(min(length(z)-.07,length(m)-.1),.3));c=W(x,0,15.25,0,999,2.2,999,0.);x.z=mod(x.z+5.,10.)-5.;z=x;vec2 r,l=y*(.2+.1*cos(2.*z.xy)+.2*cos(.3*z.xy));f=d(f,vec2(W(z,0,15.8,0,999,.85-l.x,.65-l.x,l.x),.8));z.z=abs(z.z)-1.1;z.x=mod(z.x+6.,12.)-6.;f=d(f,vec2(V(z,.5-l.y,100,.5-l.y,l.y),.5));f=d(f,vec2(V(z,.5,.3,.5,.1+.05*cos(6.*z.y)),8.5));f=d(f,vec2(W(z,0,16.8,0,.45,.45,1e3,.2),.6));f=d(f,vec2(W(z,0,14.7,0,.7,0,0,.05),.3));i=d(i,vec2(W(z,0,14.7,-.5,.2,.27,.6,.05),.5));z-=vec3(0,15.5,1.7);z.zy*=p(.72);i=d(i,vec2(V(z,.17,.2,2.6,.1),.5));z.z=abs(z.z);i=d(i,vec2(W(z,0,0,2,.7,0,0,.05),.3));z=x;z.z-=2.5;z.x=mod(z.x+30.,48.)-11.;z.y=mod(z.y+13.,17.5)-13.;f=d(f,vec2(W(z,0,1.4,0,2.4,0,.8,.1),.3));z.xz=abs(z.xz);z.xy*=p(.1);i=d(i,vec2(W(z,1.6,.6,.6,0,.7,0,.1),4.5));z=x;z.x=mod(z.x+36.,72.)-36.;c=min(c,W(z,18,0,0,6.01,999,999,0.));z=x;z.y=mod(z.y+.3,2.5)-1.25;f=d(f,vec2(max(-c,V(z,1e3,.1,.7,0.)),.8));z=x;z.y=mod(z.y-.5,2.5)-.5;float n=floor(z.x),t=floor(x.y/2.5),B=y*.5*smoothstep(65.,88.,v);r=vec2(999,0);if(y<.5||v<77.){r=vec2(z.x-n>.5?W(z,n+11.5,.75,0,10.485,.8,.462,0.):W(z,n-10.5,.8,0,10.485,.75,.462,0.),0);z.x-=n;for(b=0.;b<=.98;){l=vec2(.1+.4*(1.-y),.4)+y*vec2(.2)*s(vec2(b,n+t));l.x=min(l.x,1.-b);b+=l.x;if(l.x>B)r=d(r,a(z-vec3(b,0,0),l.x,l.y,2.+250.*s(l+n).x));}r.x=max(r.x,-c);r.x=y<.5?max(r.x,e+.5):r.x;}i.x=max(i.x,-e);return d(i,d(f,r));}vec3 a(vec3 x,vec3 m){float i=0.,r=1.,e=.02,l,p,a=.3*s(m.xy+912.*m.z).x;vec2 t;for(int B=0;B<128;B++){t=c(x+m*a);if(t.x<1e-4*a||a>50.)break;a+=.9*t.x;}p=t.y;if(p<-.5)return vec3(.7,.9,1);x+=a*m;vec3 B,G,k,E=vec3(0,max(8e-4*a,.03-y*.02),0);k=vec3(c(x-E.yxx).x,c(x-E.xyx).x,c(x-E.xxy));B=vec3(c(x+E.yxx).x,c(x+E.xyx).x,c(x+E.xxy));E=B-k;E=normalize(E-max(0.,dot(E,m))*m);G=reflect(m,E);B=15.*abs(t.x-.5*(B+k));l=min(1.,B.x+B.y+B.z);B=.5+.3*sin(vec3(.05,.08,.1)*(p-1.));if(p<.4)B=.15*d(x*vec3(.15,1.5,1.5));else if(p<.9)B=d((p==.8?x.zxy:p==.6?x.yzx:x)*.5*vec3(1.5,.15,1.5));else if(p<1.5)B=f(x.zyx);else if(p==50.5||p==50.)B=mix(vec3(.01,.3,1),B,smoothstep(.5,.6,n((p==50.?x:z)*2.,E)));E=y>0.?s(30.*x,E):E;k=normalize(vec3(.347,.78,-.752)),b=1;for(int o=0;o<24;o++){p=c(x+k*e).x;r=min(r,2.*p/e);e+=clamp(p,.02,.1);if(p<.001||e>2.5)break;}e=1.05;for(int o=0;o<5;o++)p=.02+.06*float(o),p-=c(x+E*p).x,i+=p*(e*=.95);k=dot(E,k)*clamp(r,0.,1.)*vec3(1.3,1,.7)+4.*pow(clamp(dot(G,k),0.,1.),46.)*vec3(1,.9,.7)+clamp(1.-i,0.,1.)*(.4*clamp(.5+.5*E.y,0.,1.)+.5*smoothstep(-.1,.1,G.y))*vec3(.4,.6,1)+.25*pow(clamp(1.+dot(E,m),0.,1.),2.);return mix(mix(.2+l*(2.+cos(3.*v))*vec3(.1,1,2),B,y)*k,vec3(.8,.9,1),smoothstep(10.,50.,a));}void main(){int[18] z=int[18](0,10,10,20,20,35,20,40,20,47,30,55,55,65,92,99,99,120);int[30] i=int[30](162,8,-85,162,4,-5,112,4,-8,92,16,-7,94,15,4,10,10,5,-10,24,8,-23,24,9,-4,25,7,90,1,4),f=int[30](162,4,-30,170,5,-7,120,3,-7,90,15,-5,92,14,5,0,8,5,-20,22,5,-20,22,5,-10,21,5,84,5,8);float y;vec3 b,c=vec3(i[0],i[1],i[2]),p=vec3(f[0],f[1],f[2]);for(int r=0;r<9;r++)y=smoothstep(float(z[r*2]),float(z[r*2+1]),v),c=mix(c,vec3(i[r*3+3],i[r*3+4],i[r*3+5]),y),p=mix(p,vec3(f[r*3+3],f[r*3+4],f[r*3+5]),y);y=.5*cos(.2*v);b=normalize(p-c);p=normalize(cross(b,vec3(sin(y),cos(y),0)));p=mat3(p,normalize(cross(p,b)),b)*normalize(vec3(m.xy,2));b=a(c,p);y=smoothstep(115.,125.,v);x=vec4(pow(clamp(mix(b,vec3(.1,1,2),.5*smoothstep(1.,1.3,n(2.5*m)+y))*(1.-y),0.,1.),vec3(.57)),1);}";
#endif // FRAGMENT_SHADER_INL_

